version: '2.1'
services:
    nginx:
        # image: nginx
        build:
            context: ./nginx
            dockerfile: Dockerfile
        ports:
            - "1009:80"
        # environment:
        #     - VIRTUAL_HOST=postco.test-nictiz.nl
        #     - VIRTUAL_PORT=8080
        #     - LETSENCRYPT_HOST=postco.test-nictiz.nl
        #     - LETSENCRYPT_EMAIL=mertens@nictiz.nl
        networks:
            postco-internal:
                aliases:
                    - proxy
    
    nodejs:
        build:
            context: './vue'
            dockerfile: 'Dockerfile'
        volumes:
            - './vue:/usr/src/app'
            - 'node_modules:/usr/src/app/node_modules'
        environment: 
            - CHOKIDAR_USEPOLLING=true
            - CORS_DEBUG=1
        ports:
            - '9124:8080'
networks:
    postco-internal:
        external: false
        name: postco-internal
volumes:
    node_modules: